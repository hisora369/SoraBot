import{cb as Be,bF as ye,aN as ae,cc as Oe,aQ as ue,cd as We,aO as ke,bD as ze,bE as Q,ce as de,a4 as V,cf as Ue,cg as He,ch as Pe,aS as Ee,ci as je,a5 as fe,cj as be,aT as Ge,a8 as qe}from"./index-DPvthqng.js";import{r as h,e as Ye,R as q}from"./react-router-dom-1tQCWL6Q.js";import{$ as Re,a as Ce,e as Ve}from"./usePress-D7H8h7T0.js";class Xe{get currentNode(){return this._currentNode}set currentNode(e){if(!ye(this.root,e))throw new Error("Cannot set currentNode to a node that is not contained by the root node.");const t=[];let l=e,r=e;for(this._currentNode=e;l&&l!==this.root;)if(l.nodeType===Node.DOCUMENT_FRAGMENT_NODE){const o=l,a=this._doc.createTreeWalker(o,this.whatToShow,{acceptNode:this._acceptNode});t.push(a),a.currentNode=r,this._currentSetFor.add(a),l=r=o.host}else l=l.parentNode;const n=this._doc.createTreeWalker(this.root,this.whatToShow,{acceptNode:this._acceptNode});t.push(n),n.currentNode=r,this._currentSetFor.add(n),this._walkerStack=t}get doc(){return this._doc}firstChild(){let e=this.currentNode,t=this.nextNode();return ye(e,t)?(t&&(this.currentNode=t),t):(this.currentNode=e,null)}lastChild(){let t=this._walkerStack[0].lastChild();return t&&(this.currentNode=t),t}nextNode(){const e=this._walkerStack[0].nextNode();if(e){if(e.shadowRoot){var t;let r;if(typeof this.filter=="function"?r=this.filter(e):!((t=this.filter)===null||t===void 0)&&t.acceptNode&&(r=this.filter.acceptNode(e)),r===NodeFilter.FILTER_ACCEPT)return this.currentNode=e,e;let n=this.nextNode();return n&&(this.currentNode=n),n}return e&&(this.currentNode=e),e}else if(this._walkerStack.length>1){this._walkerStack.shift();let l=this.nextNode();return l&&(this.currentNode=l),l}else return null}previousNode(){const e=this._walkerStack[0];if(e.currentNode===e.root){if(this._currentSetFor.has(e))if(this._currentSetFor.delete(e),this._walkerStack.length>1){this._walkerStack.shift();let r=this.previousNode();return r&&(this.currentNode=r),r}else return null;return null}const t=e.previousNode();if(t){if(t.shadowRoot){var l;let n;if(typeof this.filter=="function"?n=this.filter(t):!((l=this.filter)===null||l===void 0)&&l.acceptNode&&(n=this.filter.acceptNode(t)),n===NodeFilter.FILTER_ACCEPT)return t&&(this.currentNode=t),t;let o=this.lastChild();return o&&(this.currentNode=o),o}return t&&(this.currentNode=t),t}else if(this._walkerStack.length>1){this._walkerStack.shift();let r=this.previousNode();return r&&(this.currentNode=r),r}else return null}nextSibling(){return null}previousSibling(){return null}parentNode(){return null}constructor(e,t,l,r){this._walkerStack=[],this._currentSetFor=new Set,this._acceptNode=o=>{if(o.nodeType===Node.ELEMENT_NODE){const u=o.shadowRoot;if(u){const p=this._doc.createTreeWalker(u,this.whatToShow,{acceptNode:this._acceptNode});return this._walkerStack.unshift(p),NodeFilter.FILTER_ACCEPT}else{var a;if(typeof this.filter=="function")return this.filter(o);if(!((a=this.filter)===null||a===void 0)&&a.acceptNode)return this.filter.acceptNode(o);if(this.filter===null)return NodeFilter.FILTER_ACCEPT}}return NodeFilter.FILTER_SKIP},this._doc=e,this.root=t,this.filter=r??null,this.whatToShow=l??NodeFilter.SHOW_ALL,this._currentNode=t,this._walkerStack.unshift(e.createTreeWalker(t,l,this._acceptNode));const n=t.shadowRoot;if(n){const o=this._doc.createTreeWalker(n,this.whatToShow,{acceptNode:this._acceptNode});this._walkerStack.unshift(o)}}}function Je(i,e,t,l){return Be()?new Xe(i,e,t,l):i.createTreeWalker(e,t,l)}function $e(i,e){const t=h.useRef(!0),l=h.useRef(null);ae(()=>(t.current=!0,()=>{t.current=!1}),[]),ae(()=>{t.current?t.current=!1:(!l.current||e.some((r,n)=>!Object.is(r,l[n])))&&i(),l.current=e},e)}function Qe(i,e){if(!i)return!1;let t=window.getComputedStyle(i),l=/(auto|scroll)/.test(t.overflow+t.overflowX+t.overflowY);return l&&e&&(l=i.scrollHeight!==i.clientHeight||i.scrollWidth!==i.clientWidth),l}function Ze(i,e){const t=[];for(;i&&i!==document.documentElement;)Qe(i,e)&&t.push(i),i=i.parentElement;return t}function Y(i){return Oe()?i.metaKey:i.ctrlKey}let _e=0;const ne=new Map;function et(i){let[e,t]=h.useState();return ae(()=>{if(!i)return;let l=ne.get(i);if(l)t(l.element.id);else{let r=`react-aria-description-${_e++}`;t(r);let n=document.createElement("div");n.id=r,n.style.display="none",n.textContent=i,document.body.appendChild(n),l={refCount:0,element:n},ne.set(i,l)}return l.refCount++,()=>{l&&--l.refCount===0&&(l.element.remove(),ne.delete(i))}},[i]),{"aria-describedby":i?e:void 0}}function X(i,e,t,l){let r=ue(t),n=t==null;h.useEffect(()=>{if(n||!i.current)return;let o=i.current;return o.addEventListener(e,r,l),()=>{o.removeEventListener(e,r,l)}},[i,e,l,n,r])}function Ne(i,e){let t=ge(i,e,"left"),l=ge(i,e,"top"),r=e.offsetWidth,n=e.offsetHeight,o=i.scrollLeft,a=i.scrollTop,{borderTopWidth:u,borderLeftWidth:p,scrollPaddingTop:E,scrollPaddingRight:g,scrollPaddingBottom:v,scrollPaddingLeft:K}=getComputedStyle(i),{scrollMarginTop:$,scrollMarginRight:N,scrollMarginBottom:y,scrollMarginLeft:x}=getComputedStyle(e),b=o+parseInt(p,10),S=a+parseInt(u,10),w=b+i.clientWidth,I=S+i.clientHeight,P=parseInt(E,10)||0,R=parseInt(v,10)||0,F=parseInt(g,10)||0,L=parseInt(K,10)||0,O=parseInt($,10)||0,M=parseInt(y,10)||0,D=parseInt(N,10)||0,k=parseInt(x,10)||0,U=t-k,W=t+r+D,H=l-O,c=l+n+M,f=o+parseInt(p,10)+L,m=w-F,s=a+parseInt(u,10)+P,T=I-R;(U>f||W<m)&&(U<=o+L?o=U-parseInt(p,10)-L:W>w-F&&(o+=W-w+F)),(H>s||c<T)&&(H<=S+P?a=H-parseInt(u,10)-P:c>I-R&&(a+=c-I+R)),i.scrollTo({left:o,top:a})}function ge(i,e,t){const l=t==="left"?"offsetLeft":"offsetTop";let r=0;for(;e.offsetParent&&(r+=e[l],e.offsetParent!==i);){if(e.offsetParent.contains(i)){r-=i[l];break}e=e.offsetParent}return r}function Se(i,e){if(i&&document.contains(i)){let o=document.scrollingElement||document.documentElement;if(!(window.getComputedStyle(o).overflow==="hidden")&&!We()){var t;let{left:u,top:p}=i.getBoundingClientRect();i==null||(t=i.scrollIntoView)===null||t===void 0||t.call(i,{block:"nearest"});let{left:E,top:g}=i.getBoundingClientRect();if(Math.abs(u-E)>1||Math.abs(p-g)>1){var l,r,n;e==null||(r=e.containingElement)===null||r===void 0||(l=r.scrollIntoView)===null||l===void 0||l.call(r,{block:"center",inline:"center"}),(n=i.scrollIntoView)===null||n===void 0||n.call(i,{block:"nearest"})}}else{let u=Ze(i);for(let p of u)Ne(p,i)}}}const tt="react-aria-clear-focus",lt="react-aria-focus";let oe=new Map;function wt(i){let{locale:e}=ke(),t=e+(i?Object.entries(i).sort((r,n)=>r[0]<n[0]?-1:1).join():"");if(oe.has(t))return oe.get(t);let l=new Intl.Collator(e,i);return oe.set(t,l),l}const it=500;function rt(i){let{isDisabled:e,onLongPressStart:t,onLongPressEnd:l,onLongPress:r,threshold:n=it,accessibilityDescription:o}=i;const a=h.useRef(void 0);let{addGlobalListener:u,removeGlobalListener:p}=ze(),{pressProps:E}=Re({isDisabled:e,onPressStart(v){if(v.continuePropagation(),(v.pointerType==="mouse"||v.pointerType==="touch")&&(t&&t({...v,type:"longpressstart"}),a.current=setTimeout(()=>{v.target.dispatchEvent(new PointerEvent("pointercancel",{bubbles:!0})),Q(v.target).activeElement!==v.target&&de(v.target),r&&r({...v,type:"longpress"}),a.current=void 0},n),v.pointerType==="touch")){let K=$=>{$.preventDefault()};u(v.target,"contextmenu",K,{once:!0}),u(window,"pointerup",()=>{setTimeout(()=>{p(v.target,"contextmenu",K)},30)},{once:!0})}},onPressEnd(v){a.current&&clearTimeout(a.current),l&&(v.pointerType==="mouse"||v.pointerType==="touch")&&l({...v,type:"longpressend"})}}),g=et(r&&!e?o:void 0);return{longPressProps:V(E,g)}}function nt(i){if(i.checked)return!0;let e=[];if(!i.form)e=[...Q(i).querySelectorAll(`input[type="radio"][name="${CSS.escape(i.name)}"]`)].filter(n=>!n.form);else{var t,l;let n=(l=i.form)===null||l===void 0||(t=l.elements)===null||t===void 0?void 0:t.namedItem(i.name);e=[...n??[]]}return e?!e.some(n=>n.checked):!1}function Ie(i,e){return!i||!e?!1:e.some(t=>t.contains(i))}function ot(i,e,t){let l=e!=null&&e.tabbable?Ue:He,r=(i==null?void 0:i.nodeType)===Node.ELEMENT_NODE?i:null,n=Q(r),o=Je(n,i||n,NodeFilter.SHOW_ELEMENT,{acceptNode(a){var u;return!(e==null||(u=e.from)===null||u===void 0)&&u.contains(a)||e!=null&&e.tabbable&&a.tagName==="INPUT"&&a.getAttribute("type")==="radio"&&(!nt(a)||o.currentNode.tagName==="INPUT"&&o.currentNode.type==="radio"&&o.currentNode.name===a.name)?NodeFilter.FILTER_REJECT:l(a)&&(!t||Ie(a,t))&&(!(e!=null&&e.accept)||e.accept(a))?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});return e!=null&&e.from&&(o.currentNode=e.from),o}class pe{get size(){return this.fastMap.size}getTreeNode(e){return this.fastMap.get(e)}addTreeNode(e,t,l){let r=this.fastMap.get(t??null);if(!r)return;let n=new me({scopeRef:e});r.addChild(n),n.parent=r,this.fastMap.set(e,n),l&&(n.nodeToRestore=l)}addNode(e){this.fastMap.set(e.scopeRef,e)}removeTreeNode(e){if(e===null)return;let t=this.fastMap.get(e);if(!t)return;let l=t.parent;for(let n of this.traverse())n!==t&&t.nodeToRestore&&n.nodeToRestore&&t.scopeRef&&t.scopeRef.current&&Ie(n.nodeToRestore,t.scopeRef.current)&&(n.nodeToRestore=t.nodeToRestore);let r=t.children;l&&(l.removeChild(t),r.size>0&&r.forEach(n=>l&&l.addChild(n))),this.fastMap.delete(t.scopeRef)}*traverse(e=this.root){if(e.scopeRef!=null&&(yield e),e.children.size>0)for(let t of e.children)yield*this.traverse(t)}clone(){var e;let t=new pe;var l;for(let r of this.traverse())t.addTreeNode(r.scopeRef,(l=(e=r.parent)===null||e===void 0?void 0:e.scopeRef)!==null&&l!==void 0?l:null,r.nodeToRestore);return t}constructor(){this.fastMap=new Map,this.root=new me({scopeRef:null}),this.fastMap.set(null,this.root)}}class me{addChild(e){this.children.add(e),e.parent=this}removeChild(e){this.children.delete(e),e.parent=void 0}constructor(e){this.children=new Set,this.contain=!1,this.scopeRef=e.scopeRef}}new pe;function De(i){let e=ct(Q(i));e!==i&&(e&&st(e,i),i&&Me(i,e))}function st(i,e){i.dispatchEvent(new FocusEvent("blur",{relatedTarget:e})),i.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:e}))}function Me(i,e){i.dispatchEvent(new FocusEvent("focus",{relatedTarget:e})),i.dispatchEvent(new FocusEvent("focusin",{bubbles:!0,relatedTarget:e}))}function ct(i){let e=Pe(i),t=e==null?void 0:e.getAttribute("aria-activedescendant");return t&&i.getElementById(t)||e}function he(i){return je()?i.altKey:i.ctrlKey}function J(i,e){var t,l;let r=`[data-key="${CSS.escape(String(e))}"]`,n=(t=i.current)===null||t===void 0?void 0:t.dataset.collection;return n&&(r=`[data-collection="${CSS.escape(n)}"]${r}`),(l=i.current)===null||l===void 0?void 0:l.querySelector(r)}const Ae=new WeakMap;function at(i){let e=Ee();return Ae.set(i,e),e}function ut(i){return Ae.get(i)}const dt=1e3;function ft(i){let{keyboardDelegate:e,selectionManager:t,onTypeSelect:l}=i,r=h.useRef({search:"",timeout:void 0}).current,n=o=>{let a=ht(o.key);if(!(!a||o.ctrlKey||o.metaKey||!o.currentTarget.contains(o.target)||r.search.length===0&&a===" ")){if(a===" "&&r.search.trim().length>0&&(o.preventDefault(),"continuePropagation"in o||o.stopPropagation()),r.search+=a,e.getKeyForSearch!=null){let u=e.getKeyForSearch(r.search,t.focusedKey);u==null&&(u=e.getKeyForSearch(r.search)),u!=null&&(t.setFocusedKey(u),l&&l(u))}clearTimeout(r.timeout),r.timeout=setTimeout(()=>{r.search=""},dt)}};return{typeSelectProps:{onKeyDownCapture:e.getKeyForSearch?n:void 0}}}function ht(i){return i.length===1||!/^[A-Z]/i.test(i)?i:""}function Tt(i){let{selectionManager:e,keyboardDelegate:t,ref:l,autoFocus:r=!1,shouldFocusWrap:n=!1,disallowEmptySelection:o=!1,disallowSelectAll:a=!1,escapeKeyBehavior:u="clearSelection",selectOnFocus:p=e.selectionBehavior==="replace",disallowTypeAhead:E=!1,shouldUseVirtualFocus:g,allowsTabNavigation:v=!1,isVirtualized:K,scrollRef:$=l,linkBehavior:N="action"}=i,{direction:y}=ke(),x=Ce(),b=c=>{var f;if(c.altKey&&c.key==="Tab"&&c.preventDefault(),!(!((f=l.current)===null||f===void 0)&&f.contains(c.target)))return;const m=(d,j)=>{if(d!=null){if(e.isLink(d)&&N==="selection"&&p&&!he(c)){Ye.flushSync(()=>{e.setFocusedKey(d,j)});let G=J(l,d),ve=e.getItemProps(d);G&&x.open(G,c,ve.href,ve.routerOptions);return}if(e.setFocusedKey(d,j),e.isLink(d)&&N==="override")return;c.shiftKey&&e.selectionMode==="multiple"?e.extendSelection(d):p&&!he(c)&&e.replaceSelection(d)}};switch(c.key){case"ArrowDown":if(t.getKeyBelow){var s,T,C;let d=e.focusedKey!=null?(s=t.getKeyBelow)===null||s===void 0?void 0:s.call(t,e.focusedKey):(T=t.getFirstKey)===null||T===void 0?void 0:T.call(t);d==null&&n&&(d=(C=t.getFirstKey)===null||C===void 0?void 0:C.call(t,e.focusedKey)),d!=null&&(c.preventDefault(),m(d))}break;case"ArrowUp":if(t.getKeyAbove){var B,z,Z;let d=e.focusedKey!=null?(B=t.getKeyAbove)===null||B===void 0?void 0:B.call(t,e.focusedKey):(z=t.getLastKey)===null||z===void 0?void 0:z.call(t);d==null&&n&&(d=(Z=t.getLastKey)===null||Z===void 0?void 0:Z.call(t,e.focusedKey)),d!=null&&(c.preventDefault(),m(d))}break;case"ArrowLeft":if(t.getKeyLeftOf){var _,ee,te;let d=e.focusedKey!=null?(_=t.getKeyLeftOf)===null||_===void 0?void 0:_.call(t,e.focusedKey):null;d==null&&n&&(d=y==="rtl"?(ee=t.getFirstKey)===null||ee===void 0?void 0:ee.call(t,e.focusedKey):(te=t.getLastKey)===null||te===void 0?void 0:te.call(t,e.focusedKey)),d!=null&&(c.preventDefault(),m(d,y==="rtl"?"first":"last"))}break;case"ArrowRight":if(t.getKeyRightOf){var le,ie,re;let d=e.focusedKey!=null?(le=t.getKeyRightOf)===null||le===void 0?void 0:le.call(t,e.focusedKey):null;d==null&&n&&(d=y==="rtl"?(ie=t.getLastKey)===null||ie===void 0?void 0:ie.call(t,e.focusedKey):(re=t.getFirstKey)===null||re===void 0?void 0:re.call(t,e.focusedKey)),d!=null&&(c.preventDefault(),m(d,y==="rtl"?"last":"first"))}break;case"Home":if(t.getFirstKey){if(e.focusedKey===null&&c.shiftKey)return;c.preventDefault();let d=t.getFirstKey(e.focusedKey,Y(c));e.setFocusedKey(d),d!=null&&(Y(c)&&c.shiftKey&&e.selectionMode==="multiple"?e.extendSelection(d):p&&e.replaceSelection(d))}break;case"End":if(t.getLastKey){if(e.focusedKey===null&&c.shiftKey)return;c.preventDefault();let d=t.getLastKey(e.focusedKey,Y(c));e.setFocusedKey(d),d!=null&&(Y(c)&&c.shiftKey&&e.selectionMode==="multiple"?e.extendSelection(d):p&&e.replaceSelection(d))}break;case"PageDown":if(t.getKeyPageBelow&&e.focusedKey!=null){let d=t.getKeyPageBelow(e.focusedKey);d!=null&&(c.preventDefault(),m(d))}break;case"PageUp":if(t.getKeyPageAbove&&e.focusedKey!=null){let d=t.getKeyPageAbove(e.focusedKey);d!=null&&(c.preventDefault(),m(d))}break;case"a":Y(c)&&e.selectionMode==="multiple"&&a!==!0&&(c.preventDefault(),e.selectAll());break;case"Escape":u==="clearSelection"&&!o&&e.selectedKeys.size!==0&&(c.stopPropagation(),c.preventDefault(),e.clearSelection());break;case"Tab":if(!v){if(c.shiftKey)l.current.focus();else{let d=ot(l.current,{tabbable:!0}),j,G;do G=d.lastChild(),G&&(j=G);while(G);j&&!j.contains(document.activeElement)&&de(j)}break}}},S=h.useRef({top:0,left:0});X($,"scroll",K?void 0:()=>{var c,f,m,s;S.current={top:(m=(c=$.current)===null||c===void 0?void 0:c.scrollTop)!==null&&m!==void 0?m:0,left:(s=(f=$.current)===null||f===void 0?void 0:f.scrollLeft)!==null&&s!==void 0?s:0}});let w=c=>{if(e.isFocused){c.currentTarget.contains(c.target)||e.setFocused(!1);return}if(c.currentTarget.contains(c.target)){if(e.setFocused(!0),e.focusedKey==null){var f,m;let C=z=>{z!=null&&(e.setFocusedKey(z),p&&!e.isSelected(z)&&e.replaceSelection(z))},B=c.relatedTarget;var s,T;B&&c.currentTarget.compareDocumentPosition(B)&Node.DOCUMENT_POSITION_FOLLOWING?C((s=e.lastSelectedKey)!==null&&s!==void 0?s:(f=t.getLastKey)===null||f===void 0?void 0:f.call(t)):C((T=e.firstSelectedKey)!==null&&T!==void 0?T:(m=t.getFirstKey)===null||m===void 0?void 0:m.call(t))}else!K&&$.current&&($.current.scrollTop=S.current.top,$.current.scrollLeft=S.current.left);if(e.focusedKey!=null&&$.current){let C=J(l,e.focusedKey);C instanceof HTMLElement&&(!C.contains(document.activeElement)&&!g&&de(C),be()==="keyboard"&&Se(C,{containingElement:l.current}))}}},I=c=>{c.currentTarget.contains(c.relatedTarget)||e.setFocused(!1)},P=h.useRef(!1);X(l,lt,g?c=>{let{detail:f}=c;c.stopPropagation(),e.setFocused(!0),(f==null?void 0:f.focusStrategy)==="first"&&(P.current=!0)}:void 0);let R=ue(()=>{var c,f;let m=(f=(c=t.getFirstKey)===null||c===void 0?void 0:c.call(t))!==null&&f!==void 0?f:null;if(m==null){let s=Pe();De(l.current),Me(s,null),e.collection.size>0&&(P.current=!1)}else e.setFocusedKey(m),P.current=!1});$e(()=>{P.current&&R()},[e.collection,R]);let F=ue(()=>{e.collection.size>0&&(P.current=!1)});$e(()=>{F()},[e.focusedKey,F]),X(l,tt,g?c=>{var f;c.stopPropagation(),e.setFocused(!1),!((f=c.detail)===null||f===void 0)&&f.clearFocusKey&&e.setFocusedKey(null)}:void 0);const L=h.useRef(r),O=h.useRef(!1);h.useEffect(()=>{if(L.current){var c,f;let T=null;var m;r==="first"&&(T=(m=(c=t.getFirstKey)===null||c===void 0?void 0:c.call(t))!==null&&m!==void 0?m:null);var s;r==="last"&&(T=(s=(f=t.getLastKey)===null||f===void 0?void 0:f.call(t))!==null&&s!==void 0?s:null);let C=e.selectedKeys;if(C.size){for(let B of C)if(e.canSelectItem(B)){T=B;break}}e.setFocused(!0),e.setFocusedKey(T),T==null&&!g&&l.current&&fe(l.current),e.collection.size>0&&(L.current=!1,O.current=!0)}});let M=h.useRef(e.focusedKey),D=h.useRef(null);h.useEffect(()=>{if(e.isFocused&&e.focusedKey!=null&&(e.focusedKey!==M.current||O.current)&&$.current&&l.current){let c=be(),f=J(l,e.focusedKey);if(!(f instanceof HTMLElement))return;(c==="keyboard"||O.current)&&(D.current&&cancelAnimationFrame(D.current),D.current=requestAnimationFrame(()=>{$.current&&(Ne($.current,f),c!=="virtual"&&Se(f,{containingElement:l.current}))}))}!g&&e.isFocused&&e.focusedKey==null&&M.current!=null&&l.current&&fe(l.current),M.current=e.focusedKey,O.current=!1}),h.useEffect(()=>()=>{D.current&&cancelAnimationFrame(D.current)},[]),X(l,"react-aria-focus-scope-restore",c=>{c.preventDefault(),e.setFocused(!0)});let k={onKeyDown:b,onFocus:w,onBlur:I,onMouseDown(c){$.current===c.target&&c.preventDefault()}},{typeSelectProps:U}=ft({keyboardDelegate:t,selectionManager:e});E||(k=V(U,k));let W;g||(W=e.focusedKey==null?0:-1);let H=at(e.collection);return{collectionProps:V(k,{tabIndex:W,"data-collection":H})}}function xt(i){let{id:e,selectionManager:t,key:l,ref:r,shouldSelectOnPressUp:n,shouldUseVirtualFocus:o,focus:a,isDisabled:u,onAction:p,allowsDifferentPressOrigin:E,linkBehavior:g="action"}=i,v=Ce();e=Ee(e);let K=s=>{if(s.pointerType==="keyboard"&&he(s))t.toggleSelection(l);else{if(t.selectionMode==="none")return;if(t.isLink(l)){if(g==="selection"&&r.current){let T=t.getItemProps(l);v.open(r.current,s,T.href,T.routerOptions),t.setSelectedKeys(t.selectedKeys);return}else if(g==="override"||g==="none")return}t.selectionMode==="single"?t.isSelected(l)&&!t.disallowEmptySelection?t.toggleSelection(l):t.replaceSelection(l):s&&s.shiftKey?t.extendSelection(l):t.selectionBehavior==="toggle"||s&&(Y(s)||s.pointerType==="touch"||s.pointerType==="virtual")?t.toggleSelection(l):t.replaceSelection(l)}};h.useEffect(()=>{l===t.focusedKey&&t.isFocused&&(o?De(r.current):a?a():document.activeElement!==r.current&&r.current&&fe(r.current))},[r,l,t.focusedKey,t.childFocusStrategy,t.isFocused,o]),u=u||t.isDisabled(l);let $={};!o&&!u?$={tabIndex:l===t.focusedKey?0:-1,onFocus(s){s.target===r.current&&t.setFocusedKey(l)}}:u&&($.onMouseDown=s=>{s.preventDefault()});let N=t.isLink(l)&&g==="override",y=p&&i.UNSTABLE_itemBehavior==="action",x=t.isLink(l)&&g!=="selection"&&g!=="none",b=!u&&t.canSelectItem(l)&&!N&&!y,S=(p||x)&&!u,w=S&&(t.selectionBehavior==="replace"?!b:!b||t.isEmpty),I=S&&b&&t.selectionBehavior==="replace",P=w||I,R=h.useRef(null),F=P&&b,L=h.useRef(!1),O=h.useRef(!1),M=t.getItemProps(l),D=s=>{if(p){var T;p(),(T=r.current)===null||T===void 0||T.dispatchEvent(new CustomEvent("react-aria-item-action",{bubbles:!0}))}x&&r.current&&v.open(r.current,s,M.href,M.routerOptions)},k={ref:r};if(n?(k.onPressStart=s=>{R.current=s.pointerType,L.current=F,s.pointerType==="keyboard"&&(!P||we())&&K(s)},E?(k.onPressUp=w?void 0:s=>{s.pointerType==="mouse"&&b&&K(s)},k.onPress=w?D:s=>{s.pointerType!=="keyboard"&&s.pointerType!=="mouse"&&b&&K(s)}):k.onPress=s=>{if(w||I&&s.pointerType!=="mouse"){if(s.pointerType==="keyboard"&&!Ke())return;D(s)}else s.pointerType!=="keyboard"&&b&&K(s)}):(k.onPressStart=s=>{R.current=s.pointerType,L.current=F,O.current=w,b&&(s.pointerType==="mouse"&&!w||s.pointerType==="keyboard"&&(!S||we()))&&K(s)},k.onPress=s=>{(s.pointerType==="touch"||s.pointerType==="pen"||s.pointerType==="virtual"||s.pointerType==="keyboard"&&P&&Ke()||s.pointerType==="mouse"&&O.current)&&(P?D(s):b&&K(s))}),$["data-collection"]=ut(t.collection),$["data-key"]=l,k.preventFocusOnPress=o,o&&(k=V(k,{onPressStart(s){s.pointerType!=="touch"&&(t.setFocused(!0),t.setFocusedKey(l))},onPress(s){s.pointerType==="touch"&&(t.setFocused(!0),t.setFocusedKey(l))}})),M)for(let s of["onPressStart","onPressEnd","onPressChange","onPress","onPressUp","onClick"])M[s]&&(k[s]=Ge(k[s],M[s]));let{pressProps:U,isPressed:W}=Re(k),H=I?s=>{R.current==="mouse"&&(s.stopPropagation(),s.preventDefault(),D(s))}:void 0,{longPressProps:c}=rt({isDisabled:!F,onLongPress(s){s.pointerType==="touch"&&(K(s),t.setSelectionBehavior("toggle"))}}),f=s=>{R.current==="touch"&&L.current&&s.preventDefault()},m=g!=="none"&&t.isLink(l)?s=>{Ve.isOpening||s.preventDefault()}:void 0;return{itemProps:V($,b||w||o&&!u?U:{},F?c:{},{onDoubleClick:H,onDragStartCapture:f,onClick:m,id:e},o?{onMouseDown:s=>s.preventDefault()}:void 0),isPressed:W,isSelected:t.isSelected(l),isFocused:t.isFocused&&t.focusedKey===l,isDisabled:u,allowsSelection:b,hasAction:P}}function Ke(){let i=window.event;return(i==null?void 0:i.key)==="Enter"}function we(){let i=window.event;return(i==null?void 0:i.key)===" "||(i==null?void 0:i.code)==="Space"}class Ft{getItemRect(e){let t=this.ref.current;if(!t)return null;let l=e!=null?J(this.ref,e):null;if(!l)return null;let r=t.getBoundingClientRect(),n=l.getBoundingClientRect();return{x:n.left-r.left-t.clientLeft+t.scrollLeft,y:n.top-r.top-t.clientTop+t.scrollTop,width:n.width,height:n.height}}getContentSize(){let e=this.ref.current;var t,l;return{width:(t=e==null?void 0:e.scrollWidth)!==null&&t!==void 0?t:0,height:(l=e==null?void 0:e.scrollHeight)!==null&&l!==void 0?l:0}}getVisibleRect(){let e=this.ref.current;var t,l,r,n;return{x:(t=e==null?void 0:e.scrollLeft)!==null&&t!==void 0?t:0,y:(l=e==null?void 0:e.scrollTop)!==null&&l!==void 0?l:0,width:(r=e==null?void 0:e.clientWidth)!==null&&r!==void 0?r:0,height:(n=e==null?void 0:e.clientHeight)!==null&&n!==void 0?n:0}}constructor(e){this.ref=e}}class A extends Set{constructor(e,t,l){super(e),e instanceof A?(this.anchorKey=t??e.anchorKey,this.currentKey=l??e.currentKey):(this.anchorKey=t??null,this.currentKey=l??null)}}function pt(i,e){if(i.size!==e.size)return!1;for(let t of i)if(!e.has(t))return!1;return!0}function kt(i){let{selectionMode:e="none",disallowEmptySelection:t=!1,allowDuplicateSelectionEvents:l,selectionBehavior:r="toggle",disabledBehavior:n="all"}=i,o=h.useRef(!1),[,a]=h.useState(!1),u=h.useRef(null),p=h.useRef(null),[,E]=h.useState(null),g=h.useMemo(()=>Te(i.selectedKeys),[i.selectedKeys]),v=h.useMemo(()=>Te(i.defaultSelectedKeys,new A),[i.defaultSelectedKeys]),[K,$]=qe(g,v,i.onSelectionChange),N=h.useMemo(()=>i.disabledKeys?new Set(i.disabledKeys):new Set,[i.disabledKeys]),[y,x]=h.useState(r);r==="replace"&&y==="toggle"&&typeof K=="object"&&K.size===0&&x("replace");let b=h.useRef(r);return h.useEffect(()=>{r!==b.current&&(x(r),b.current=r)},[r]),{selectionMode:e,disallowEmptySelection:t,selectionBehavior:y,setSelectionBehavior:x,get isFocused(){return o.current},setFocused(S){o.current=S,a(S)},get focusedKey(){return u.current},get childFocusStrategy(){return p.current},setFocusedKey(S,w="first"){u.current=S,p.current=w,E(S)},selectedKeys:K,setSelectedKeys(S){(l||!pt(S,K))&&$(S)},disabledKeys:N,disabledBehavior:n}}function Te(i,e){return i?i==="all"?"all":new A(i):e}class vt{build(e,t){return this.context=t,xe(()=>this.iterateCollection(e))}*iterateCollection(e){let{children:t,items:l}=e;if(q.isValidElement(t)&&t.type===q.Fragment)yield*this.iterateCollection({children:t.props.children,items:l});else if(typeof t=="function"){if(!l)throw new Error("props.children was a function but props.items is missing");let r=0;for(let n of l)yield*this.getFullNode({value:n,index:r},{renderer:t}),r++}else{let r=[];q.Children.forEach(t,o=>{o&&r.push(o)});let n=0;for(let o of r){let a=this.getFullNode({element:o,index:n},{});for(let u of a)n++,yield u}}}getKey(e,t,l,r){if(e.key!=null)return e.key;if(t.type==="cell"&&t.key!=null)return`${r}${t.key}`;let n=t.value;if(n!=null){var o;let a=(o=n.key)!==null&&o!==void 0?o:n.id;if(a==null)throw new Error("No key found for item");return a}return r?`${r}.${t.index}`:`$.${t.index}`}getChildState(e,t){return{renderer:t.renderer||e.renderer}}*getFullNode(e,t,l,r){if(q.isValidElement(e.element)&&e.element.type===q.Fragment){let y=[];q.Children.forEach(e.element.props.children,b=>{y.push(b)});var n;let x=(n=e.index)!==null&&n!==void 0?n:0;for(const b of y)yield*this.getFullNode({element:b,index:x++},t,l,r);return}let o=e.element;if(!o&&e.value&&t&&t.renderer){let y=this.cache.get(e.value);if(y&&(!y.shouldInvalidate||!y.shouldInvalidate(this.context))){y.index=e.index,y.parentKey=r?r.key:null,yield y;return}o=t.renderer(e.value)}if(q.isValidElement(o)){let y=o.type;if(typeof y!="function"&&typeof y.getCollectionNode!="function"){let w=o.type;throw new Error(`Unknown element <${w}> in collection.`)}let x=y.getCollectionNode(o.props,this.context);var a;let b=(a=e.index)!==null&&a!==void 0?a:0,S=x.next();for(;!S.done&&S.value;){let w=S.value;e.index=b;var u;let I=(u=w.key)!==null&&u!==void 0?u:null;I==null&&(I=w.element?null:this.getKey(o,e,t,l));let R=[...this.getFullNode({...w,key:I,index:b,wrapper:yt(e.wrapper,w.wrapper)},this.getChildState(t,w),l?`${l}${o.key}`:o.key,r)];for(let F of R){var p,E;F.value=(E=(p=w.value)!==null&&p!==void 0?p:e.value)!==null&&E!==void 0?E:null,F.value&&this.cache.set(F.value,F);var g;if(e.type&&F.type!==e.type)throw new Error(`Unsupported type <${se(F.type)}> in <${se((g=r==null?void 0:r.type)!==null&&g!==void 0?g:"unknown parent type")}>. Only <${se(e.type)}> is supported.`);b++,yield F}S=x.next(R)}return}if(e.key==null||e.type==null)return;let v=this;var K,$;let N={type:e.type,props:e.props,key:e.key,parentKey:r?r.key:null,value:(K=e.value)!==null&&K!==void 0?K:null,level:r?r.level+1:0,index:e.index,rendered:e.rendered,textValue:($=e.textValue)!==null&&$!==void 0?$:"","aria-label":e["aria-label"],wrapper:e.wrapper,shouldInvalidate:e.shouldInvalidate,hasChildNodes:e.hasChildNodes||!1,childNodes:xe(function*(){if(!e.hasChildNodes||!e.childNodes)return;let y=0;for(let x of e.childNodes()){x.key!=null&&(x.key=`${N.key}${x.key}`);let b=v.getFullNode({...x,index:y},v.getChildState(t,x),N.key,N);for(let S of b)y++,yield S}})};yield N}constructor(){this.cache=new WeakMap}}function xe(i){let e=[],t=null;return{*[Symbol.iterator](){for(let l of e)yield l;t||(t=i());for(let l of t)e.push(l),yield l}}}function yt(i,e){if(i&&e)return t=>i(e(t));if(i)return i;if(e)return e}function se(i){return i[0].toUpperCase()+i.slice(1)}function Pt(i,e,t){let l=h.useMemo(()=>new vt,[]),{children:r,items:n,collection:o}=i;return h.useMemo(()=>{if(o)return o;let u=l.build({children:r,items:n},t);return e(u)},[l,r,n,o,t,e])}function bt(i,e){return typeof e.getChildren=="function"?e.getChildren(i.key):i.childNodes}function $t(i){return gt(i,0)}function gt(i,e){if(e<0)return;let t=0;for(let l of i){if(t===e)return l;t++}}function Et(i){let e;for(let t of i)e=t;return e}function ce(i,e,t){if(e.parentKey===t.parentKey)return e.index-t.index;let l=[...Fe(i,e),e],r=[...Fe(i,t),t],n=l.slice(0,r.length).findIndex((o,a)=>o!==r[a]);return n!==-1?(e=l[n],t=r[n],e.index-t.index):l.findIndex(o=>o===t)>=0?1:(r.findIndex(o=>o===e)>=0,-1)}function Fe(i,e){let t=[],l=e;for(;(l==null?void 0:l.parentKey)!=null;)l=i.getItem(l.parentKey),l&&t.unshift(l);return t}class Le{get selectionMode(){return this.state.selectionMode}get disallowEmptySelection(){return this.state.disallowEmptySelection}get selectionBehavior(){return this.state.selectionBehavior}setSelectionBehavior(e){this.state.setSelectionBehavior(e)}get isFocused(){return this.state.isFocused}setFocused(e){this.state.setFocused(e)}get focusedKey(){return this.state.focusedKey}get childFocusStrategy(){return this.state.childFocusStrategy}setFocusedKey(e,t){(e==null||this.collection.getItem(e))&&this.state.setFocusedKey(e,t)}get selectedKeys(){return this.state.selectedKeys==="all"?new Set(this.getSelectAllKeys()):this.state.selectedKeys}get rawSelection(){return this.state.selectedKeys}isSelected(e){if(this.state.selectionMode==="none")return!1;let t=this.getKey(e);return t==null?!1:this.state.selectedKeys==="all"?this.canSelectItem(t):this.state.selectedKeys.has(t)}get isEmpty(){return this.state.selectedKeys!=="all"&&this.state.selectedKeys.size===0}get isSelectAll(){if(this.isEmpty)return!1;if(this.state.selectedKeys==="all")return!0;if(this._isSelectAll!=null)return this._isSelectAll;let e=this.getSelectAllKeys(),t=this.state.selectedKeys;return this._isSelectAll=e.every(l=>t.has(l)),this._isSelectAll}get firstSelectedKey(){let e=null;for(let l of this.state.selectedKeys){let r=this.collection.getItem(l);(!e||r&&ce(this.collection,r,e)<0)&&(e=r)}var t;return(t=e==null?void 0:e.key)!==null&&t!==void 0?t:null}get lastSelectedKey(){let e=null;for(let l of this.state.selectedKeys){let r=this.collection.getItem(l);(!e||r&&ce(this.collection,r,e)>0)&&(e=r)}var t;return(t=e==null?void 0:e.key)!==null&&t!==void 0?t:null}get disabledKeys(){return this.state.disabledKeys}get disabledBehavior(){return this.state.disabledBehavior}extendSelection(e){if(this.selectionMode==="none")return;if(this.selectionMode==="single"){this.replaceSelection(e);return}let t=this.getKey(e);if(t==null)return;let l;if(this.state.selectedKeys==="all")l=new A([t],t,t);else{let o=this.state.selectedKeys;var r;let a=(r=o.anchorKey)!==null&&r!==void 0?r:t;l=new A(o,a,t);var n;for(let u of this.getKeyRange(a,(n=o.currentKey)!==null&&n!==void 0?n:t))l.delete(u);for(let u of this.getKeyRange(t,a))this.canSelectItem(u)&&l.add(u)}this.state.setSelectedKeys(l)}getKeyRange(e,t){let l=this.collection.getItem(e),r=this.collection.getItem(t);return l&&r?ce(this.collection,l,r)<=0?this.getKeyRangeInternal(e,t):this.getKeyRangeInternal(t,e):[]}getKeyRangeInternal(e,t){var l;if(!((l=this.layoutDelegate)===null||l===void 0)&&l.getKeyRange)return this.layoutDelegate.getKeyRange(e,t);let r=[],n=e;for(;n!=null;){let o=this.collection.getItem(n);if(o&&(o.type==="item"||o.type==="cell"&&this.allowsCellSelection)&&r.push(n),n===t)return r;n=this.collection.getKeyAfter(n)}return[]}getKey(e){let t=this.collection.getItem(e);if(!t||t.type==="cell"&&this.allowsCellSelection)return e;for(;t&&t.type!=="item"&&t.parentKey!=null;)t=this.collection.getItem(t.parentKey);return!t||t.type!=="item"?null:t.key}toggleSelection(e){if(this.selectionMode==="none")return;if(this.selectionMode==="single"&&!this.isSelected(e)){this.replaceSelection(e);return}let t=this.getKey(e);if(t==null)return;let l=new A(this.state.selectedKeys==="all"?this.getSelectAllKeys():this.state.selectedKeys);l.has(t)?l.delete(t):this.canSelectItem(t)&&(l.add(t),l.anchorKey=t,l.currentKey=t),!(this.disallowEmptySelection&&l.size===0)&&this.state.setSelectedKeys(l)}replaceSelection(e){if(this.selectionMode==="none")return;let t=this.getKey(e);if(t==null)return;let l=this.canSelectItem(t)?new A([t],t,t):new A;this.state.setSelectedKeys(l)}setSelectedKeys(e){if(this.selectionMode==="none")return;let t=new A;for(let l of e){let r=this.getKey(l);if(r!=null&&(t.add(r),this.selectionMode==="single"))break}this.state.setSelectedKeys(t)}getSelectAllKeys(){let e=[],t=l=>{for(;l!=null;){if(this.canSelectItem(l)){var r;let o=this.collection.getItem(l);(o==null?void 0:o.type)==="item"&&e.push(l);var n;o!=null&&o.hasChildNodes&&(this.allowsCellSelection||o.type!=="item")&&t((n=(r=$t(bt(o,this.collection)))===null||r===void 0?void 0:r.key)!==null&&n!==void 0?n:null)}l=this.collection.getKeyAfter(l)}};return t(this.collection.getFirstKey()),e}selectAll(){!this.isSelectAll&&this.selectionMode==="multiple"&&this.state.setSelectedKeys("all")}clearSelection(){!this.disallowEmptySelection&&(this.state.selectedKeys==="all"||this.state.selectedKeys.size>0)&&this.state.setSelectedKeys(new A)}toggleSelectAll(){this.isSelectAll?this.clearSelection():this.selectAll()}select(e,t){this.selectionMode!=="none"&&(this.selectionMode==="single"?this.isSelected(e)&&!this.disallowEmptySelection?this.toggleSelection(e):this.replaceSelection(e):this.selectionBehavior==="toggle"||t&&(t.pointerType==="touch"||t.pointerType==="virtual")?this.toggleSelection(e):this.replaceSelection(e))}isSelectionEqual(e){if(e===this.state.selectedKeys)return!0;let t=this.selectedKeys;if(e.size!==t.size)return!1;for(let l of e)if(!t.has(l))return!1;for(let l of t)if(!e.has(l))return!1;return!0}canSelectItem(e){var t;if(this.state.selectionMode==="none"||this.state.disabledKeys.has(e))return!1;let l=this.collection.getItem(e);return!(!l||!(l==null||(t=l.props)===null||t===void 0)&&t.isDisabled||l.type==="cell"&&!this.allowsCellSelection)}isDisabled(e){var t,l;return this.state.disabledBehavior==="all"&&(this.state.disabledKeys.has(e)||!!(!((l=this.collection.getItem(e))===null||l===void 0||(t=l.props)===null||t===void 0)&&t.isDisabled))}isLink(e){var t,l;return!!(!((l=this.collection.getItem(e))===null||l===void 0||(t=l.props)===null||t===void 0)&&t.href)}getItemProps(e){var t;return(t=this.collection.getItem(e))===null||t===void 0?void 0:t.props}withCollection(e){return new Le(e,this.state,{allowsCellSelection:this.allowsCellSelection,layoutDelegate:this.layoutDelegate||void 0})}constructor(e,t,l){this.collection=e,this.state=t;var r;this.allowsCellSelection=(r=l==null?void 0:l.allowsCellSelection)!==null&&r!==void 0?r:!1,this._isSelectAll=null,this.layoutDelegate=(l==null?void 0:l.layoutDelegate)||null}}export{kt as $,Pt as a,Le as b,Qe as c,ot as d,bt as e,Et as f,$t as g,gt as h,Ft as i,et as j,wt as k,Tt as l,xt as m,Se as n,rt as o};
